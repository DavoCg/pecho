var jwt = require('jsonwebtoken');

module.exports = function(req, res, next){
    var token = req.headers.token;
    var secret = 'seCretString97NotTobeHere@';

    if(!token) return res.status(403).send('Please log in');
    jwt.verify(token, secret, function(err, decoded){
        if(err) return next(err);
        if(Math.round(Date.now()/1000) > decoded.exp) res.status(403).send('Token expired');
        next();
    });

};