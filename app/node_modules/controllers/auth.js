var User = require('models').User;
var jwt = require('jsonwebtoken');

module.exports = {
    login: function(req, res, next){
        User.findOne({name: req.body.name}, function(err, result){
            if(err) return next(err);
            if(!result) return res.status(401).send('User not found');
            var token = generateToken(result);
            res.status(200).send(token);
        });
    },
    logout: function(req, res, next){

    }
};

function generateToken(user){
    var secret = 'seCretString97NotTobeHere@';
    var options = {
        expiresInSeconds: 1800,
        ignoreExpiration: true
    };
    return jwt.sign({ user: user }, secret, options);
}