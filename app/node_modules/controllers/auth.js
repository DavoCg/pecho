var jwt = require('jsonwebtoken');
var validator = require('validator');
var HTTPStatus = require('http-status');


function auth(client){
    return {
        login: function(credentials, callback){

            if(!credentials.email || validator.isEmail(credentials.email)) return callback(new Error('Email not valid'));
            if(!credentials.password) return callback(new Error('Provide a password'));

            var token = generateToken(user);
            return callback(null, {statusCode: HTTPStatus.OK, data: token});
        },
        logout: function(callback){
            // here we set the token to expirated
            callback(null, {statusCode: HTTPStatus.OK, data: 'User well loggedOut'});
        }
    }
}

function generateToken(user){
    var secret = 'seCretString97NotTobeHere@';
    var options = {
        expiresInSeconds: 1800,
        ignoreExpiration: true
    };
    return jwt.sign({ user: user }, secret, options);
}

module.exports = auth;