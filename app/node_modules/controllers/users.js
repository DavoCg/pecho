var User = require('models').User;
var is = require('is_js');

module.exports = {
    addUser: function(user, callback){
        if(!user.email || is.not.email(user.email)) return callback(new Error('Please provide a valid email'));
        if(!user.password) return callback(new Error('Please provide a password'));

        var newUser = new User(user);
        newUser.password = newUser.generateHash(user.password);

        User.findOne({email: user.email}, function(err, user){
            if(err) return callback(err);
            if(user) return callback(new Error('Email already taken'));
            newUser.save(function(err){
                if(err) return callback(err);
                return callback(null, {statusCode: 200, data: newUser})
            });
        });
    }
};