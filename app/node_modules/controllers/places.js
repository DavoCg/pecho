var queries = require('es-queries');
var config = require('configator');
var queryValidator = require('query-validator');
var _ = require('lodash');

function places(client){
    return {
        getPlaces: function(query, callback){
            var q = queryValidator(query, 'places');
            if(q.errorMess) return callback(new Error(q.errorMess));

            client.search(queries.places.all(q)).then(function(resp){
                var places = _.map(resp.hits.hits, function(place){
                    return _.assign({id: place._id}, place._source);
                });
                return callback(null, places);
            }, callback);

        },

        getPlace: function(params, callback){
            return callback(null, 'on place')
        },

        addPlace: function(place, callback){
            return callback(null, 'new place');
        }
    }
}

module.exports = places;